text(-1.6, c(-6.75), bquote(paste("p ", .(metafor:::.pval(FPS6RMA1$QMp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6RMA1$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6RMA1$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(31, 30), pos = 4, c("Tigecycline Resistance in", "Carbapenem Resistant Isolates"), font = 2, cex = 0.8)
text(-1.6, c(18, 17), pos = 4, c("Tigecycline Resistance in", "Naive Isolates (SG2)"), font = 2, cex = 0.8)
text(-1.6, c(33), pos = 4, c("Subgroups/Author(s)"), font = 2, cex = 0.75)
text(1.545, c(34), pos = 4, c("Trait-"), font = 2, cex = 0.75)
text(1.545, c(33), pos = 4, c("Species"), font = 2, cex = 0.75)
text(1.215, c(33), pos = 4, c("Sample"), font = 2, cex = 0.75)
text(1.925, c(33), pos = 4, c("Weight% IR[95% CI]"), font = 2, cex = 0.75)
RMASG1 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR, subset = (SubGroup=="SG1"))
RMASG2 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR, subset = (SubGroup=="SG2"))
addpoly(RMASG1, row = 20.5, cex = 0.7, mlab = "", border = 0, col = rgb(64, 64, 64, maxColorValue = 255))
addpoly(RMASG2, row = 2.5, cex = 0.7, mlab = "", border = 0, col = rgb(64, 64, 64, maxColorValue = 255))
text(-1.6, c(21.75), pos = 4, c("RE Model for Subgroup"), font = 2, cex = 0.65)
text(-1.6, c(20.5), bquote(paste("(",Tau^2, " = ",.(formatC(RMASG1$tau2, digits=4, format="f")), ", df = ",
.(RMASG1$k - RMASG1$p), ", ", "Q = ", .(formatC(RMASG1$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(19.5), bquote(paste("p ", .(metafor:::.pval(RMASG1$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(RMASG1$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(RMASG1$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(3.75), pos = 4, c("RE Model for Subgroup"), font = 2, cex = 0.65)
text(-1.6, c(2.5), bquote(paste("(",Tau^2, " = ",.(formatC(RMASG2$tau2, digits=4, format="f")), ", df = ",
.(RMASG2$k - RMASG2$p), ", ", "Q = ", .(formatC(RMASG2$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(1.5), bquote(paste("p ", .(metafor:::.pval(RMASG2$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(RMASG2$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(RMASG2$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
dev.off()
library(readxl)
FPS6 <- read_excel("C:/Users/drmum/OneDrive - Higher Education Commission/Carbapenemase Metaanalysis/Forest Plots/FPDataSup2.xlsx",
sheet = "FPS6", range = "A1:U20")
FPS6IR <- escalc(measure = "IR", xi = FPS6$xi, ti = FPS6$ti, data = FPS6, replace = FALSE)
FPS6RMA <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR)
FPS6RMA1 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, mods = ~ SubGroup, data = FPS6IR)
###########
pdf(file = "FPS6.1.pdf", family = "Times", height = 14, width = 8.5)
par(mar = c(4,7,1,5))
## c(4,8,1,6)
forest.rma(FPS6RMA, slab = paste(FPS6$Author, FPS6$`Pub Year`), ilab = cbind(FPS6$ilab2, FPS6$ilab1), ilab.pos = 4,
ilab.xpos = c(1.545, 1.215), digits = c(2, 1), at = c(-0.5, 0, 0.5, 1, 1.5), mlab = "",
refline = 0.06, xlim = c(-1.6, 2.8), showweights = TRUE, efac = 0.75, header = FALSE,
cex = 0.65, rows = c(29:23, 16:5), ylim = c(-3, 103), cex.lab = 0.75, top = 72)
text(-1.6, c(-1), pos = 4, c("RE Model for All Studies"), font = 2, cex = 0.65)
text(-1.6, c(-2.25), bquote(paste("(",Tau^2, " = ",.(formatC(FPS6RMA$tau2, digits=4, format="f")), ", df = ",
.(FPS6RMA$k - FPS6RMA$p), ", ", "Q = ", .(formatC(FPS6RMA$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-3.25), bquote(paste("p ", .(metafor:::.pval(FPS6RMA$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6RMA$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6RMA$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(-4.5), pos = 4, c("Test for Subgroup Differences"), font = 2, cex = 0.65)
text(-1.6, c(-5.75), bquote(paste("(", Tau^2, " = ",.(formatC(FPS6RMA1$tau2, digits=4, format="f")),", df = ", .(FPS6RMA1$p - 1),
", ", Q[M], " = ", .(formatC(FPS6RMA1$QM, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-6.75), bquote(paste("p ", .(metafor:::.pval(FPS6RMA1$QMp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6RMA1$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6RMA1$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(31, 30), pos = 4, c("Tigecycline Resistance in", "Carbapenem Resistant Isolates"), font = 2, cex = 0.8)
text(-1.6, c(18, 17), pos = 4, c("Tigecycline Resistance in", "Naive Isolates (SG2)"), font = 2, cex = 0.8)
text(-1.6, c(33), pos = 4, c("Subgroups/Author(s)"), font = 2, cex = 0.75)
text(1.545, c(34), pos = 4, c("Trait-"), font = 2, cex = 0.75)
text(1.545, c(33), pos = 4, c("Species"), font = 2, cex = 0.75)
text(1.215, c(33), pos = 4, c("Sample"), font = 2, cex = 0.75)
text(1.925, c(33), pos = 4, c("Weight% IR[95% CI]"), font = 2, cex = 0.75)
RMASG1 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR, subset = (SubGroup=="SG1"))
RMASG2 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR, subset = (SubGroup=="SG2"))
addpoly(RMASG1, row = 20.5, cex = 0.7, mlab = "", border = 0, col = rgb(64, 64, 64, maxColorValue = 255))
addpoly(RMASG2, row = 2.5, cex = 0.7, mlab = "", border = 0, col = rgb(64, 64, 64, maxColorValue = 255))
text(-1.6, c(21.75), pos = 4, c("RE Model for Subgroup"), font = 2, cex = 0.65)
text(-1.6, c(20.5), bquote(paste("(",Tau^2, " = ",.(formatC(RMASG1$tau2, digits=4, format="f")), ", df = ",
.(RMASG1$k - RMASG1$p), ", ", "Q = ", .(formatC(RMASG1$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(19.5), bquote(paste("p ", .(metafor:::.pval(RMASG1$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(RMASG1$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(RMASG1$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(3.75), pos = 4, c("RE Model for Subgroup"), font = 2, cex = 0.65)
text(-1.6, c(2.5), bquote(paste("(",Tau^2, " = ",.(formatC(RMASG2$tau2, digits=4, format="f")), ", df = ",
.(RMASG2$k - RMASG2$p), ", ", "Q = ", .(formatC(RMASG2$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(1.5), bquote(paste("p ", .(metafor:::.pval(RMASG2$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(RMASG2$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(RMASG2$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
dev.off()
library(metafor)
library(readxl)
FPS6.1 <- read_excel("C:/Users/drmum/OneDrive - Higher Education Commission/Carbapenemase Metaanalysis/Forest Plots/FPDataSup2.xlsx",
sheet = "FPS6", range = "A22:U34")
FPS6.1IR <- escalc(measure = "IR", xi = FPS6.1$xi, ti = FPS6.1$ti, data = FPS6.1, replace = FALSE)
FPS6.1RMA <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6.1IR)
FPS6.1RMA1 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, mods = ~ SubGroup, data = FPS6.1IR)
###########
pdf(file = "FPS6.2.pdf", family = "Times", height = 14, width = 8.5)
par(mar = c(4,7,1,5))
## c(4,8,1,6)
forest.rma(FPS6.1RMA, slab = paste(FPS6.1$Author, FPS6.1$`Pub Year`), ilab = cbind(FPS6.1$ilab2, FPS6.1$ilab1), ilab.pos = 4,
ilab.xpos = c(1.545, 1.215), digits = c(2, 1), at = c(-0.5, 0, 0.5, 1, 1.5), mlab = "",
refline = 0.36, xlim = c(-1.6, 2.8), showweights = TRUE, efac = 0.75, header = FALSE,
cex = 0.65, rows = c(12:1), ylim = c(0, 103), cex.lab = 0.75, top = 89)
text(-1.6, c(-1), pos = 4, c("RE Model for All Studies"), font = 2, cex = 0.65)
text(-1.6, c(-2.25), bquote(paste("(",Tau^2, " = ",.(formatC(FPS6.1RMA$tau2, digits=4, format="f")), ", df = ",
.(FPS6.1RMA$k - FPS6.1RMA$p), ", ", "Q = ", .(formatC(FPS6.1RMA$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-3.25), bquote(paste("p ", .(metafor:::.pval(FPS6.1RMA$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6.1RMA$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6.1RMA$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(14, 13), pos = 4, c("Carbapenem Resistance in", "Naive Isolates (SG2)"), font = 2, cex = 0.8)
text(-1.6, c(16), pos = 4, c("Subgroups/Author(s)"), font = 2, cex = 0.75)
text(1.545, c(17), pos = 4, c("Trait-"), font = 2, cex = 0.75)
text(1.545, c(16), pos = 4, c("Species"), font = 2, cex = 0.75)
text(1.215, c(16), pos = 4, c("Sample"), font = 2, cex = 0.75)
text(1.925, c(16), pos = 4, c("Weight% IR[95% CI]"), font = 2, cex = 0.75)
dev.off()
library(readxl)
FPS6 <- read_excel("C:/Users/drmum/OneDrive - Higher Education Commission/Carbapenemase Metaanalysis/Forest Plots/FPDataSup2.xlsx",
sheet = "FPS6", range = "A1:U20")
FPS6IR <- escalc(measure = "IR", xi = FPS6$xi, ti = FPS6$ti, data = FPS6, replace = FALSE)
FPS6RMA <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR)
FPS6RMA1 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, mods = ~ SubGroup, data = FPS6IR)
###########
pdf(file = "FPS6.1.pdf", family = "Times", height = 14, width = 8.5)
par(mar = c(4,7,1,5))
## c(4,8,1,6)
forest.rma(FPS6RMA, slab = paste(FPS6$Author, FPS6$`Pub Year`), ilab = cbind(FPS6$ilab2, FPS6$ilab1), ilab.pos = 4,
ilab.xpos = c(1.545, 1.215), digits = c(2, 1), at = c(-0.5, 0, 0.5, 1, 1.5), mlab = "",
refline = 0.06, xlim = c(-1.6, 2.8), showweights = TRUE, efac = 0.75, header = FALSE,
cex = 0.65, rows = c(29:23, 16:5), ylim = c(-3, 103), cex.lab = 0.75, top = 72)
text(-1.6, c(-1), pos = 4, c("RE Model for All Studies"), font = 2, cex = 0.65)
text(-1.6, c(-2.25), bquote(paste("(",Tau^2, " = ",.(formatC(FPS6RMA$tau2, digits=4, format="f")), ", df = ",
.(FPS6RMA$k - FPS6RMA$p), ", ", "Q = ", .(formatC(FPS6RMA$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-3.25), bquote(paste("p ", .(metafor:::.pval(FPS6RMA$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6RMA$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6RMA$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(-4.5), pos = 4, c("Test for Subgroup Differences"), font = 2, cex = 0.65)
text(-1.6, c(-5.75), bquote(paste("(", Tau^2, " = ",.(formatC(FPS6RMA1$tau2, digits=4, format="f")),", df = ", .(FPS6RMA1$p - 1),
", ", Q[M], " = ", .(formatC(FPS6RMA1$QM, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-6.75), bquote(paste("p ", .(metafor:::.pval(FPS6RMA1$QMp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6RMA1$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6RMA1$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(31, 30), pos = 4, c("Tigecycline Resistance in", "Carbapenem Resistant Isolates"), font = 2, cex = 0.8)
text(-1.6, c(18, 17), pos = 4, c("Tigecycline Resistance in", "Naive Isolates (SG2)"), font = 2, cex = 0.8)
text(-1.6, c(33), pos = 4, c("Subgroups/Author(s)"), font = 2, cex = 0.75)
text(1.545, c(34), pos = 4, c("Trait-"), font = 2, cex = 0.75)
text(1.545, c(33), pos = 4, c("Species"), font = 2, cex = 0.75)
text(1.215, c(33), pos = 4, c("Sample"), font = 2, cex = 0.75)
text(1.925, c(33), pos = 4, c("Weight% IR[95% CI]"), font = 2, cex = 0.75)
RMASG1 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR, subset = (SubGroup=="SG1"))
RMASG2 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR, subset = (SubGroup=="SG2"))
addpoly(RMASG1, row = 20.5, cex = 0.7, mlab = "", border = 0, col = rgb(64, 64, 64, maxColorValue = 255))
addpoly(RMASG2, row = 2.5, cex = 0.7, mlab = "", border = 0, col = rgb(64, 64, 64, maxColorValue = 255))
text(-1.6, c(21.75), pos = 4, c("RE Model for Subgroup"), font = 2, cex = 0.65)
text(-1.6, c(20.5), bquote(paste("(",Tau^2, " = ",.(formatC(RMASG1$tau2, digits=4, format="f")), ", df = ",
.(RMASG1$k - RMASG1$p), ", ", "Q = ", .(formatC(RMASG1$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(19.5), bquote(paste("p ", .(metafor:::.pval(RMASG1$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(RMASG1$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(RMASG1$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(3.75), pos = 4, c("RE Model for Subgroup"), font = 2, cex = 0.65)
text(-1.6, c(2.5), bquote(paste("(",Tau^2, " = ",.(formatC(RMASG2$tau2, digits=4, format="f")), ", df = ",
.(RMASG2$k - RMASG2$p), ", ", "Q = ", .(formatC(RMASG2$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(1.5), bquote(paste("p ", .(metafor:::.pval(RMASG2$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(RMASG2$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(RMASG2$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
dev.off()
library(metafor)
library(readxl)
FPS6.1 <- read_excel("C:/Users/drmum/OneDrive - Higher Education Commission/Carbapenemase Metaanalysis/Forest Plots/FPDataSup2.xlsx",
sheet = "FPS6", range = "A22:U34")
FPS6.1IR <- escalc(measure = "IR", xi = FPS6.1$xi, ti = FPS6.1$ti, data = FPS6.1, replace = FALSE)
FPS6.1RMA <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6.1IR)
###########
pdf(file = "FPS6.2.pdf", family = "Times", height = 14, width = 8.5)
par(mar = c(4,7,1,5))
## c(4,8,1,6)
forest.rma(FPS6.1RMA, slab = paste(FPS6.1$Author, FPS6.1$`Pub Year`), ilab = cbind(FPS6.1$ilab2, FPS6.1$ilab1), ilab.pos = 4,
ilab.xpos = c(1.545, 1.215), digits = c(2, 1), at = c(-0.5, 0, 0.5, 1, 1.5), mlab = "",
refline = 0.36, xlim = c(-1.6, 2.8), showweights = TRUE, efac = 0.75, header = FALSE,
cex = 0.65, rows = c(12:1), ylim = c(0, 103), cex.lab = 0.75, top = 89)
text(-1.6, c(-1), pos = 4, c("RE Model for All Studies"), font = 2, cex = 0.65)
text(-1.6, c(-2.25), bquote(paste("(",Tau^2, " = ",.(formatC(FPS6.1RMA$tau2, digits=4, format="f")), ", df = ",
.(FPS6.1RMA$k - FPS6.1RMA$p), ", ", "Q = ", .(formatC(FPS6.1RMA$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-3.25), bquote(paste("p ", .(metafor:::.pval(FPS6.1RMA$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6.1RMA$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6.1RMA$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(14, 13), pos = 4, c("Carbapenem Resistance in", "Naive Isolates (SG2)"), font = 2, cex = 0.8)
text(-1.6, c(16), pos = 4, c("Subgroups/Author(s)"), font = 2, cex = 0.75)
text(1.545, c(17), pos = 4, c("Trait-"), font = 2, cex = 0.75)
text(1.545, c(16), pos = 4, c("Species"), font = 2, cex = 0.75)
text(1.215, c(16), pos = 4, c("Sample"), font = 2, cex = 0.75)
text(1.925, c(16), pos = 4, c("Weight% IR[95% CI]"), font = 2, cex = 0.75)
dev.off()
library(metafor)
library(readxl)
FPS6.1 <- read_excel("C:/Users/drmum/OneDrive - Higher Education Commission/Carbapenemase Metaanalysis/Forest Plots/FPDataSup2.xlsx",
sheet = "FPS6", range = "A22:U34")
FPS6.1IR <- escalc(measure = "IR", xi = FPS6.1$xi, ti = FPS6.1$ti, data = FPS6.1, replace = FALSE)
FPS6.1RMA <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6.1IR)
###########
pdf(file = "FPS6.2.pdf", family = "Times", height = 14, width = 8.5)
par(mar = c(4,7,1,5))
## c(4,8,1,6)
forest.rma(FPS6.1RMA, slab = paste(FPS6.1$Author, FPS6.1$`Pub Year`), ilab = cbind(FPS6.1$ilab2, FPS6.1$ilab1), ilab.pos = 4,
ilab.xpos = c(1.545, 1.215), digits = c(2, 1), at = c(-0.5, 0, 0.5, 1, 1.5), mlab = "",
refline = 0.36, xlim = c(-1.6, 2.8), showweights = TRUE, efac = 0.75, header = FALSE,
cex = 0.65, rows = c(12:1), ylim = c(0, 103), cex.lab = 0.75, top = 89)
text(-1.6, c(-1), pos = 4, c("RE Model for All Studies"), font = 2, cex = 0.65)
text(-1.6, c(-2.25), bquote(paste("(",Tau^2, " = ",.(formatC(FPS6.1RMA$tau2, digits=4, format="f")), ", df = ",
.(FPS6.1RMA$k - FPS6.1RMA$p), ", ", "Q = ", .(formatC(FPS6.1RMA$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-3.25), bquote(paste("p ", .(metafor:::.pval(FPS6.1RMA$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6.1RMA$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6.1RMA$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(14, 13), pos = 4, c("Carbapenem Resistance in", "Naive Isolates (SG2)"), font = 2, cex = 0.8)
text(-1.6, c(16), pos = 4, c("Subgroups/Author(s)"), font = 2, cex = 0.75)
text(1.545, c(17), pos = 4, c("Trait-"), font = 2, cex = 0.75)
text(1.545, c(16), pos = 4, c("Species"), font = 2, cex = 0.75)
text(1.215, c(16), pos = 4, c("Sample"), font = 2, cex = 0.75)
text(1.925, c(16), pos = 4, c("Weight% IR[95% CI]"), font = 2, cex = 0.75)
dev.off()
library(readxl)
FPS6 <- read_excel("C:/Users/drmum/OneDrive - Higher Education Commission/Carbapenemase Metaanalysis/Forest Plots/FPDataSup2.xlsx",
sheet = "FPS6", range = "A1:U20")
FPS6IR <- escalc(measure = "IR", xi = FPS6$xi, ti = FPS6$ti, data = FPS6, replace = FALSE)
FPS6RMA <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR)
FPS6RMA1 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, mods = ~ SubGroup, data = FPS6IR)
###########
pdf(file = "FPS6.1.pdf", family = "Times", height = 14, width = 8.5)
par(mar = c(4,7,1,5))
## c(4,8,1,6)
forest.rma(FPS6RMA, slab = paste(FPS6$Author, FPS6$`Pub Year`), ilab = cbind(FPS6$ilab2, FPS6$ilab1), ilab.pos = 4,
ilab.xpos = c(1.545, 1.215), digits = c(2, 1), at = c(-0.5, 0, 0.5, 1, 1.5), mlab = "",
refline = 0.06, xlim = c(-1.6, 2.8), showweights = TRUE, efac = 0.75, header = FALSE,
cex = 0.65, rows = c(29:23, 16:5), ylim = c(-3, 103), cex.lab = 0.75, top = 72)
text(-1.6, c(-1), pos = 4, c("RE Model for All Studies"), font = 2, cex = 0.65)
text(-1.6, c(-2.25), bquote(paste("(",Tau^2, " = ",.(formatC(FPS6RMA$tau2, digits=4, format="f")), ", df = ",
.(FPS6RMA$k - FPS6RMA$p), ", ", "Q = ", .(formatC(FPS6RMA$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-3.25), bquote(paste("p ", .(metafor:::.pval(FPS6RMA$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6RMA$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6RMA$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(-4.5), pos = 4, c("Test for Subgroup Differences"), font = 2, cex = 0.65)
text(-1.6, c(-5.75), bquote(paste("(", Tau^2, " = ",.(formatC(FPS6RMA1$tau2, digits=4, format="f")),", df = ", .(FPS6RMA1$p - 1),
", ", Q[M], " = ", .(formatC(FPS6RMA1$QM, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-6.75), bquote(paste("p ", .(metafor:::.pval(FPS6RMA1$QMp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6RMA1$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6RMA1$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(31, 30), pos = 4, c("Tigecycline Resistance in", "Carbapenem Resistant Isolates"), font = 2, cex = 0.8)
text(-1.6, c(18, 17), pos = 4, c("Tigecycline Resistance in", "Naive Isolates (SG2)"), font = 2, cex = 0.8)
text(-1.6, c(33), pos = 4, c("Subgroups/Author(s)"), font = 2, cex = 0.75)
text(1.545, c(34), pos = 4, c("Trait-"), font = 2, cex = 0.75)
text(1.545, c(33), pos = 4, c("Species"), font = 2, cex = 0.75)
text(1.215, c(33), pos = 4, c("Sample"), font = 2, cex = 0.75)
text(1.925, c(33), pos = 4, c("Weight% IR[95% CI]"), font = 2, cex = 0.75)
RMASG1 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR, subset = (SubGroup=="SG1"))
RMASG2 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR, subset = (SubGroup=="SG2"))
addpoly(RMASG1, row = 20.5, cex = 0.7, mlab = "", border = 0, col = rgb(64, 64, 64, maxColorValue = 255))
addpoly(RMASG2, row = 2.5, cex = 0.7, mlab = "", border = 0, col = rgb(64, 64, 64, maxColorValue = 255))
text(-1.6, c(21.75), pos = 4, c("RE Model for Subgroup"), font = 2, cex = 0.65)
text(-1.6, c(20.5), bquote(paste("(",Tau^2, " = ",.(formatC(RMASG1$tau2, digits=4, format="f")), ", df = ",
.(RMASG1$k - RMASG1$p), ", ", "Q = ", .(formatC(RMASG1$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(19.5), bquote(paste("p ", .(metafor:::.pval(RMASG1$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(RMASG1$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(RMASG1$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(3.75), pos = 4, c("RE Model for Subgroup"), font = 2, cex = 0.65)
text(-1.6, c(2.5), bquote(paste("(",Tau^2, " = ",.(formatC(RMASG2$tau2, digits=4, format="f")), ", df = ",
.(RMASG2$k - RMASG2$p), ", ", "Q = ", .(formatC(RMASG2$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(1.5), bquote(paste("p ", .(metafor:::.pval(RMASG2$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(RMASG2$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(RMASG2$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
dev.off()
library(metafor)
pdf(file = "FPS6.1.pdf", family = "Times", height = 14, width = 8.5)
par(mar = c(4,7,1,5))
## c(4,8,1,6)
forest.rma(FPS6RMA, slab = paste(FPS6$Author, FPS6$`Pub Year`), ilab = cbind(FPS6$ilab2, FPS6$ilab1), ilab.pos = 4,
ilab.xpos = c(1.545, 1.215), digits = c(2, 1), at = c(-0.5, 0, 0.5, 1, 1.5), mlab = "",
refline = 0.06, xlim = c(-1.6, 2.8), showweights = TRUE, efac = 0.75, header = FALSE,
cex = 0.65, rows = c(29:23, 16:5), ylim = c(-3, 103), cex.lab = 0.75, top = 72)
text(-1.6, c(-1), pos = 4, c("RE Model for All Studies"), font = 2, cex = 0.65)
text(-1.6, c(-2.25), bquote(paste("(",Tau^2, " = ",.(formatC(FPS6RMA$tau2, digits=4, format="f")), ", df = ",
.(FPS6RMA$k - FPS6RMA$p), ", ", "Q = ", .(formatC(FPS6RMA$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-3.25), bquote(paste("p ", .(metafor:::.pval(FPS6RMA$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6RMA$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6RMA$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(-4.5), pos = 4, c("Test for Subgroup Differences"), font = 2, cex = 0.65)
text(-1.6, c(-5.75), bquote(paste("(", Tau^2, " = ",.(formatC(FPS6RMA1$tau2, digits=4, format="f")),", df = ", .(FPS6RMA1$p - 1),
", ", Q[M], " = ", .(formatC(FPS6RMA1$QM, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-6.75), bquote(paste("p ", .(metafor:::.pval(FPS6RMA1$QMp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6RMA1$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6RMA1$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(31, 30), pos = 4, c("Tigecycline Resistance in", "Carbapenem Resistant Isolates"), font = 2, cex = 0.8)
text(-1.6, c(18, 17), pos = 4, c("Tigecycline Resistance in", "Naive Isolates (SG2)"), font = 2, cex = 0.8)
text(-1.6, c(34.25), pos = 4, c("Enterobacteriaceae + Non-Enterobacteriaceae"), font = 4, cex = 0.9)
text(-1.6, c(33), pos = 4, c("Subgroups/Author(s)"), font = 2, cex = 0.75)
text(1.545, c(34), pos = 4, c("Trait-"), font = 2, cex = 0.75)
text(1.545, c(33), pos = 4, c("Species"), font = 2, cex = 0.75)
text(1.215, c(33), pos = 4, c("Sample"), font = 2, cex = 0.75)
text(1.925, c(33), pos = 4, c("Weight% IR[95% CI]"), font = 2, cex = 0.75)
RMASG1 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR, subset = (SubGroup=="SG1"))
RMASG2 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR, subset = (SubGroup=="SG2"))
addpoly(RMASG1, row = 20.5, cex = 0.7, mlab = "", border = 0, col = rgb(64, 64, 64, maxColorValue = 255))
addpoly(RMASG2, row = 2.5, cex = 0.7, mlab = "", border = 0, col = rgb(64, 64, 64, maxColorValue = 255))
text(-1.6, c(21.75), pos = 4, c("RE Model for Subgroup"), font = 2, cex = 0.65)
text(-1.6, c(20.5), bquote(paste("(",Tau^2, " = ",.(formatC(RMASG1$tau2, digits=4, format="f")), ", df = ",
.(RMASG1$k - RMASG1$p), ", ", "Q = ", .(formatC(RMASG1$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(19.5), bquote(paste("p ", .(metafor:::.pval(RMASG1$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(RMASG1$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(RMASG1$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(3.75), pos = 4, c("RE Model for Subgroup"), font = 2, cex = 0.65)
text(-1.6, c(2.5), bquote(paste("(",Tau^2, " = ",.(formatC(RMASG2$tau2, digits=4, format="f")), ", df = ",
.(RMASG2$k - RMASG2$p), ", ", "Q = ", .(formatC(RMASG2$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(1.5), bquote(paste("p ", .(metafor:::.pval(RMASG2$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(RMASG2$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(RMASG2$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
dev.off()
library(metafor)
library(readxl)
FPS6.1 <- read_excel("C:/Users/drmum/OneDrive - Higher Education Commission/Carbapenemase Metaanalysis/Forest Plots/FPDataSup2.xlsx",
sheet = "FPS6", range = "A22:U34")
FPS6.1IR <- escalc(measure = "IR", xi = FPS6.1$xi, ti = FPS6.1$ti, data = FPS6.1, replace = FALSE)
FPS6.1RMA <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6.1IR)
###########
pdf(file = "FPS6.2.pdf", family = "Times", height = 14, width = 8.5)
par(mar = c(4,7,1,5))
## c(4,8,1,6)
forest.rma(FPS6.1RMA, slab = paste(FPS6.1$Author, FPS6.1$`Pub Year`), ilab = cbind(FPS6.1$ilab2, FPS6.1$ilab1), ilab.pos = 4,
ilab.xpos = c(1.545, 1.215), digits = c(2, 1), at = c(-0.5, 0, 0.5, 1, 1.5), mlab = "",
refline = 0.36, xlim = c(-1.6, 2.8), showweights = TRUE, efac = 0.75, header = FALSE,
cex = 0.65, rows = c(12:1), ylim = c(0, 103), cex.lab = 0.75, top = 89)
text(-1.6, c(-1), pos = 4, c("RE Model for All Studies"), font = 2, cex = 0.65)
text(-1.6, c(-2.25), bquote(paste("(",Tau^2, " = ",.(formatC(FPS6.1RMA$tau2, digits=4, format="f")), ", df = ",
.(FPS6.1RMA$k - FPS6.1RMA$p), ", ", "Q = ", .(formatC(FPS6.1RMA$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-3.25), bquote(paste("p ", .(metafor:::.pval(FPS6.1RMA$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6.1RMA$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6.1RMA$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(14, 13), pos = 4, c("Carbapenem Resistance in", "Naive Isolates (SG2)"), font = 2, cex = 0.8)
text(-1.6, c(16), pos = 4, c("Subgroups/Author(s)"), font = 2, cex = 0.75)
text(1.545, c(17), pos = 4, c("Trait-"), font = 2, cex = 0.75)
text(1.545, c(16), pos = 4, c("Species"), font = 2, cex = 0.75)
text(1.215, c(16), pos = 4, c("Sample"), font = 2, cex = 0.75)
text(1.925, c(16), pos = 4, c("Weight% IR[95% CI]"), font = 2, cex = 0.75)
dev.off()
library(readxl)
FPS6 <- read_excel("C:/Users/drmum/OneDrive - Higher Education Commission/Carbapenemase Metaanalysis/Forest Plots/FPDataSup2.xlsx",
sheet = "FPS6", range = "A1:U20")
FPS6IR <- escalc(measure = "IR", xi = FPS6$xi, ti = FPS6$ti, data = FPS6, replace = FALSE)
FPS6RMA <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR)
FPS6RMA1 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, mods = ~ SubGroup, data = FPS6IR)
###########
pdf(file = "FPS6.1.pdf", family = "Times", height = 14, width = 8.5)
par(mar = c(4,7,1,5))
## c(4,8,1,6)
forest.rma(FPS6RMA, slab = paste(FPS6$Author, FPS6$`Pub Year`), ilab = cbind(FPS6$ilab2, FPS6$ilab1), ilab.pos = 4,
ilab.xpos = c(1.545, 1.215), digits = c(2, 1), at = c(-0.5, 0, 0.5, 1, 1.5), mlab = "",
refline = 0.06, xlim = c(-1.6, 2.8), showweights = TRUE, efac = 0.75, header = FALSE,
cex = 0.65, rows = c(29:23, 16:5), ylim = c(-3, 103), cex.lab = 0.75, top = 72)
text(-1.6, c(-1), pos = 4, c("RE Model for All Studies"), font = 2, cex = 0.65)
text(-1.6, c(-2.25), bquote(paste("(",Tau^2, " = ",.(formatC(FPS6RMA$tau2, digits=4, format="f")), ", df = ",
.(FPS6RMA$k - FPS6RMA$p), ", ", "Q = ", .(formatC(FPS6RMA$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-3.25), bquote(paste("p ", .(metafor:::.pval(FPS6RMA$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6RMA$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6RMA$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(-4.5), pos = 4, c("Test for Subgroup Differences"), font = 2, cex = 0.65)
text(-1.6, c(-5.75), bquote(paste("(", Tau^2, " = ",.(formatC(FPS6RMA1$tau2, digits=4, format="f")),", df = ", .(FPS6RMA1$p - 1),
", ", Q[M], " = ", .(formatC(FPS6RMA1$QM, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-6.75), bquote(paste("p ", .(metafor:::.pval(FPS6RMA1$QMp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6RMA1$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6RMA1$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(31, 30), pos = 4, c("Tigecycline Resistance in", "Carbapenem Resistant Isolates"), font = 2, cex = 0.8)
text(-1.6, c(18, 17), pos = 4, c("Tigecycline Resistance in", "Naive Isolates (SG2)"), font = 2, cex = 0.8)
text(-1.6, c(34.25), pos = 4, c("Enterobacteriaceae + Non-Enterobacteriaceae"), font = 4, cex = 0.9)
text(-1.6, c(33), pos = 4, c("Subgroups/Author(s)"), font = 2, cex = 0.75)
text(1.545, c(34), pos = 4, c("Trait-"), font = 2, cex = 0.75)
text(1.545, c(33), pos = 4, c("Species"), font = 2, cex = 0.75)
text(1.215, c(33), pos = 4, c("Sample"), font = 2, cex = 0.75)
text(1.925, c(33), pos = 4, c("Weight% IR[95% CI]"), font = 2, cex = 0.75)
RMASG1 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR, subset = (SubGroup=="SG1"))
RMASG2 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR, subset = (SubGroup=="SG2"))
addpoly(RMASG1, row = 20.5, cex = 0.7, mlab = "", border = 0, col = rgb(64, 64, 64, maxColorValue = 255))
addpoly(RMASG2, row = 2.5, cex = 0.7, mlab = "", border = 0, col = rgb(64, 64, 64, maxColorValue = 255))
text(-1.6, c(21.75), pos = 4, c("RE Model for Subgroup"), font = 2, cex = 0.65)
text(-1.6, c(20.5), bquote(paste("(",Tau^2, " = ",.(formatC(RMASG1$tau2, digits=4, format="f")), ", df = ",
.(RMASG1$k - RMASG1$p), ", ", "Q = ", .(formatC(RMASG1$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(19.5), bquote(paste("p ", .(metafor:::.pval(RMASG1$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(RMASG1$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(RMASG1$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(3.75), pos = 4, c("RE Model for Subgroup"), font = 2, cex = 0.65)
text(-1.6, c(2.5), bquote(paste("(",Tau^2, " = ",.(formatC(RMASG2$tau2, digits=4, format="f")), ", df = ",
.(RMASG2$k - RMASG2$p), ", ", "Q = ", .(formatC(RMASG2$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(1.5), bquote(paste("p ", .(metafor:::.pval(RMASG2$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(RMASG2$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(RMASG2$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
dev.off()
library(metafor)
pdf(file = "FPS6.2.pdf", family = "Times", height = 14, width = 8.5)
par(mar = c(4,7,1,5))
## c(4,8,1,6)
forest.rma(FPS6.1RMA, slab = paste(FPS6.1$Author, FPS6.1$`Pub Year`), ilab = cbind(FPS6.1$ilab2, FPS6.1$ilab1), ilab.pos = 4,
ilab.xpos = c(1.545, 1.215), digits = c(2, 1), at = c(-0.5, 0, 0.5, 1, 1.5), mlab = "",
refline = 0.36, xlim = c(-1.6, 2.8), showweights = TRUE, efac = 0.75, header = FALSE,
cex = 0.65, rows = c(12:1), ylim = c(0, 103), cex.lab = 0.75, top = 89)
text(-1.6, c(-1), pos = 4, c("RE Model for All Studies"), font = 2, cex = 0.65)
text(-1.6, c(-2.25), bquote(paste("(",Tau^2, " = ",.(formatC(FPS6.1RMA$tau2, digits=4, format="f")), ", df = ",
.(FPS6.1RMA$k - FPS6.1RMA$p), ", ", "Q = ", .(formatC(FPS6.1RMA$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-3.25), bquote(paste("p ", .(metafor:::.pval(FPS6.1RMA$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6.1RMA$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6.1RMA$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(14, 13), pos = 4, c("SGIII - Carbapenem Resistance in", "Naive Isolates (SG2)"), font = 2, cex = 0.8)
text(-1.6, c(16), pos = 4, c("Subgroups/Author(s)"), font = 2, cex = 0.75)
text(1.545, c(17), pos = 4, c("Trait-"), font = 2, cex = 0.75)
text(1.545, c(16), pos = 4, c("Species"), font = 2, cex = 0.75)
text(1.215, c(16), pos = 4, c("Sample"), font = 2, cex = 0.75)
text(1.925, c(16), pos = 4, c("Weight% IR[95% CI]"), font = 2, cex = 0.75)
dev.off()
pdf(file = "FPS6.1.pdf", family = "Times", height = 14, width = 8.5)
par(mar = c(4,7,1,5))
## c(4,8,1,6)
forest.rma(FPS6RMA, slab = paste(FPS6$Author, FPS6$`Pub Year`), ilab = cbind(FPS6$ilab2, FPS6$ilab1), ilab.pos = 4,
ilab.xpos = c(1.545, 1.215), digits = c(2, 1), at = c(-0.5, 0, 0.5, 1, 1.5), mlab = "",
refline = 0.06, xlim = c(-1.6, 2.8), showweights = TRUE, efac = 0.75, header = FALSE,
cex = 0.65, rows = c(29:23, 16:5), ylim = c(-3, 103), cex.lab = 0.75, top = 72)
text(-1.6, c(-1), pos = 4, c("RE Model for All Studies"), font = 2, cex = 0.65)
text(-1.6, c(-2.25), bquote(paste("(",Tau^2, " = ",.(formatC(FPS6RMA$tau2, digits=4, format="f")), ", df = ",
.(FPS6RMA$k - FPS6RMA$p), ", ", "Q = ", .(formatC(FPS6RMA$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-3.25), bquote(paste("p ", .(metafor:::.pval(FPS6RMA$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6RMA$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6RMA$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(-4.5), pos = 4, c("Test for Subgroup Differences"), font = 2, cex = 0.65)
text(-1.6, c(-5.75), bquote(paste("(", Tau^2, " = ",.(formatC(FPS6RMA1$tau2, digits=4, format="f")),", df = ", .(FPS6RMA1$p - 1),
", ", Q[M], " = ", .(formatC(FPS6RMA1$QM, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-6.75), bquote(paste("p ", .(metafor:::.pval(FPS6RMA1$QMp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6RMA1$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6RMA1$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(31, 30), pos = 4, c("SGI - Tigecycline Resistance in", "Carbapenem Resistant Isolates"), font = 2, cex = 0.8)
text(-1.6, c(18, 17), pos = 4, c("SGII - Tigecycline Resistance in", "Naive Isolates (SG2)"), font = 2, cex = 0.8)
text(-1.6, c(34.25), pos = 4, c("Enterobacteriaceae + Non-Enterobacteriaceae"), font = 4, cex = 0.9)
text(-1.6, c(33), pos = 4, c("Subgroups/Author(s)"), font = 2, cex = 0.75)
text(1.545, c(34), pos = 4, c("Trait-"), font = 2, cex = 0.75)
text(1.545, c(33), pos = 4, c("Species"), font = 2, cex = 0.75)
text(1.215, c(33), pos = 4, c("Sample"), font = 2, cex = 0.75)
text(1.925, c(33), pos = 4, c("Weight% IR[95% CI]"), font = 2, cex = 0.75)
RMASG1 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR, subset = (SubGroup=="SG1"))
RMASG2 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR, subset = (SubGroup=="SG2"))
addpoly(RMASG1, row = 20.5, cex = 0.7, mlab = "", border = 0, col = rgb(64, 64, 64, maxColorValue = 255))
addpoly(RMASG2, row = 2.5, cex = 0.7, mlab = "", border = 0, col = rgb(64, 64, 64, maxColorValue = 255))
text(-1.6, c(21.75), pos = 4, c("RE Model for Subgroup"), font = 2, cex = 0.65)
text(-1.6, c(20.5), bquote(paste("(",Tau^2, " = ",.(formatC(RMASG1$tau2, digits=4, format="f")), ", df = ",
.(RMASG1$k - RMASG1$p), ", ", "Q = ", .(formatC(RMASG1$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(19.5), bquote(paste("p ", .(metafor:::.pval(RMASG1$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(RMASG1$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(RMASG1$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(3.75), pos = 4, c("RE Model for Subgroup"), font = 2, cex = 0.65)
text(-1.6, c(2.5), bquote(paste("(",Tau^2, " = ",.(formatC(RMASG2$tau2, digits=4, format="f")), ", df = ",
.(RMASG2$k - RMASG2$p), ", ", "Q = ", .(formatC(RMASG2$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(1.5), bquote(paste("p ", .(metafor:::.pval(RMASG2$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(RMASG2$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(RMASG2$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
dev.off()
library(metafor)
pdf(file = "FPS6.2.pdf", family = "Times", height = 14, width = 8.5)
par(mar = c(4,7,1,5))
## c(4,8,1,6)
forest.rma(FPS6.1RMA, slab = paste(FPS6.1$Author, FPS6.1$`Pub Year`), ilab = cbind(FPS6.1$ilab2, FPS6.1$ilab1), ilab.pos = 4,
ilab.xpos = c(1.545, 1.215), digits = c(2, 1), at = c(-0.5, 0, 0.5, 1, 1.5), mlab = "",
refline = 0.36, xlim = c(-1.6, 2.8), showweights = TRUE, efac = 0.75, header = FALSE,
cex = 0.65, rows = c(12:1), ylim = c(0, 103), cex.lab = 0.75, top = 89)
text(-1.6, c(-1), pos = 4, c("RE Model for All Studies"), font = 2, cex = 0.65)
text(-1.6, c(-2.25), bquote(paste("(",Tau^2, " = ",.(formatC(FPS6.1RMA$tau2, digits=4, format="f")), ", df = ",
.(FPS6.1RMA$k - FPS6.1RMA$p), ", ", "Q = ", .(formatC(FPS6.1RMA$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-3.25), bquote(paste("p ", .(metafor:::.pval(FPS6.1RMA$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6.1RMA$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6.1RMA$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(14, 13), pos = 4, c("SGIII - Carbapenem Resistance in", "Naive Isolates (SG2)"), font = 2, cex = 0.8)
text(-1.6, c(16), pos = 4, c("Subgroups/Author(s)"), font = 2, cex = 0.75)
text(1.545, c(17), pos = 4, c("Trait-"), font = 2, cex = 0.75)
text(1.545, c(16), pos = 4, c("Species"), font = 2, cex = 0.75)
text(1.215, c(16), pos = 4, c("Sample"), font = 2, cex = 0.75)
text(1.9274, c(16), pos = 4, c("Weight% Pr[95% CI]"), font = 2, cex = 0.75)
dev.off()
pdf(file = "FPS6.1.pdf", family = "Times", height = 14, width = 8.5)
par(mar = c(4,7,1,5))
## c(4,8,1,6)
forest.rma(FPS6RMA, slab = paste(FPS6$Author, FPS6$`Pub Year`), ilab = cbind(FPS6$ilab2, FPS6$ilab1), ilab.pos = 4,
ilab.xpos = c(1.545, 1.215), digits = c(2, 1), at = c(-0.5, 0, 0.5, 1, 1.5), mlab = "",
refline = 0.06, xlim = c(-1.6, 2.8), showweights = TRUE, efac = 0.75, header = FALSE,
cex = 0.65, rows = c(29:23, 16:5), ylim = c(-3, 103), cex.lab = 0.75, top = 72)
text(-1.6, c(-1), pos = 4, c("RE Model for All Studies"), font = 2, cex = 0.65)
text(-1.6, c(-2.25), bquote(paste("(",Tau^2, " = ",.(formatC(FPS6RMA$tau2, digits=4, format="f")), ", df = ",
.(FPS6RMA$k - FPS6RMA$p), ", ", "Q = ", .(formatC(FPS6RMA$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-3.25), bquote(paste("p ", .(metafor:::.pval(FPS6RMA$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6RMA$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6RMA$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(-4.5), pos = 4, c("Test for Subgroup Differences"), font = 2, cex = 0.65)
text(-1.6, c(-5.75), bquote(paste("(", Tau^2, " = ",.(formatC(FPS6RMA1$tau2, digits=4, format="f")),", df = ", .(FPS6RMA1$p - 1),
", ", Q[M], " = ", .(formatC(FPS6RMA1$QM, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(-6.75), bquote(paste("p ", .(metafor:::.pval(FPS6RMA1$QMp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(FPS6RMA1$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(FPS6RMA1$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(31, 30), pos = 4, c("SGI - Tigecycline Resistance in", "Carbapenem Resistant Isolates"), font = 2, cex = 0.8)
text(-1.6, c(18, 17), pos = 4, c("SGII - Tigecycline Resistance in", "Naive Isolates (SG2)"), font = 2, cex = 0.8)
text(-1.6, c(34.25), pos = 4, c("Enterobacteriaceae + Non-Enterobacteriaceae"), font = 4, cex = 0.9)
text(-1.6, c(33), pos = 4, c("Subgroups/Author(s)"), font = 2, cex = 0.75)
text(1.545, c(34), pos = 4, c("Trait-"), font = 2, cex = 0.75)
text(1.545, c(33), pos = 4, c("Species"), font = 2, cex = 0.75)
text(1.215, c(33), pos = 4, c("Sample"), font = 2, cex = 0.75)
text(1.9274, c(33), pos = 4, c("Weight% Pr[95% CI]"), font = 2, cex = 0.75)
RMASG1 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR, subset = (SubGroup=="SG1"))
RMASG2 <- rma(yi = yi, vi = vi, method = "DL", knha = TRUE, data = FPS6IR, subset = (SubGroup=="SG2"))
addpoly(RMASG1, row = 20.5, cex = 0.7, mlab = "", border = 0, col = rgb(64, 64, 64, maxColorValue = 255))
addpoly(RMASG2, row = 2.5, cex = 0.7, mlab = "", border = 0, col = rgb(64, 64, 64, maxColorValue = 255))
text(-1.6, c(21.75), pos = 4, c("RE Model for Subgroup"), font = 2, cex = 0.65)
text(-1.6, c(20.5), bquote(paste("(",Tau^2, " = ",.(formatC(RMASG1$tau2, digits=4, format="f")), ", df = ",
.(RMASG1$k - RMASG1$p), ", ", "Q = ", .(formatC(RMASG1$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(19.5), bquote(paste("p ", .(metafor:::.pval(RMASG1$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(RMASG1$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(RMASG1$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
text(-1.6, c(3.75), pos = 4, c("RE Model for Subgroup"), font = 2, cex = 0.65)
text(-1.6, c(2.5), bquote(paste("(",Tau^2, " = ",.(formatC(RMASG2$tau2, digits=4, format="f")), ", df = ",
.(RMASG2$k - RMASG2$p), ", ", "Q = ", .(formatC(RMASG2$QE, digits=2, format="f")), ",")), pos=4, cex=0.65)
text(-1.6, c(1.5), bquote(paste("p ", .(metafor:::.pval(RMASG2$QEp, digits=4, showeq=TRUE, sep=" ")), "; ", H^2, " = ",
.(formatC(RMASG2$H2, digits=1, format="f")), ", ", I^2, " = ", .(formatC(RMASG2$I2, digits=1, format="f")),
"%)")), pos=4, cex=0.65)
dev.off()
